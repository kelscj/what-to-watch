{% extends "base.html" %}

{% block content %}
<div class ="content">
    <h1>What Should We Watch? ðŸŽ¬</h1>
    <form method="GET" action="/" class="filter-form">
        <div class="search-bar">
            <input type="text" name="query" placeholder="Search keywords for your movie recommendations (ex: Action, Cats)" value="{{ query }}" size="80">
            <button type="submit">Search Movies</button>
        </div>
        <br>
        <div class="filters">
            <div>
                <label for="genre">Genre:</label>
                <select name="genre" id="genre" multiple>
                    <option value="">Any</option>
                    {% for g in [
                        'Action & Adventure', 'Animation', 'Arts & Culture', 'Black Stories', 'Classics', 'Comedy', 'Crime', 
                        'Documentary', 'Faith & Spirituality', 'History', 'Horror', 'International', 'Kids & Family', 'Latino', 
                        'Lifestyle', 'LGBTQ+', 'Movies', 'Music', 'Mystery', 'Reality', 'Romance', 'Romance Comedy', 'Sci-Fi & Fantasy', 
                        'Science & Tech', 'Series', 'Special Interest', 'Sports', 'Talk Show', 'Teen', 'Thriller', 'TV Series'

                    ] %}
                        <option value="{{ g }}" {% if request.args.get('genre') == g %}selected{% endif %}>{{ g }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label for="service">Streaming Service:</label>
                <select id="service" name="service" multiple>
                {% for s in ['Netflix', 'Hulu', 'Disney Plus', 'Amazon Prime'] %}
                    <option value="{{ s }}" {% if s in selected_services %}selected{% endif %}>{{ s }}</option>
                {% endfor %}
                </select>

            </div>
            <div>
                <label for="type">TV Show vs Movie:</label>
                <select id="type" name="type">
                <option value="">-- Select filter option --</option>
                {% for t in ['Movie', 'TV Show'] %}
                    <option value="{{ t }}" {% if t == selected_type %}selected{% endif %}>{{ t }}</option>
                {% endfor %}
                </select>

            </div>
            <div>
                <label for="rating">Rating:</label>
                <select id="rating" name="rating" multiple>
                {% for r in ['TV-G', 'TV-PG', 'Not Rated', 'PG-13', 'TV-14', 'TV-Y7', 'TV-Y', 'TV-MA', 'R', 'Ages 13+', 'Ages 18+', 'Ages 16+'] %}
                    <option value="{{ r }}" {% if r in selected_ratings %}selected{% endif %}>{{ r }}</option>
                {% endfor %}
                </select>

            </div>
        </div>
    </form>


    {% if tasks %}
        <h2>Results:</h2>
        <ul>
        {% for task in tasks %}
            <li>
                <strong>{{ task.title }}</strong> - {{ task.listed_in }} - {{task.duration}} - {{task.release_year}} - {{task.rating}}<br>
                Stream on: <strong>{{ task.service }}</strong> - Directed by: {{ task.director }} <br>
                <em>{{ task.description }}</em>
            </li>
        {% endfor %}
        </ul>
    {% elif query or selected_genres or selected_ratings or selected_type or selected_services %}
        <p>No results found.</p>
    {% endif %}
</div>
{% endblock %}

